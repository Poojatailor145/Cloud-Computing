<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-straight/css/uicons-regular-straight.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <title>Coziture</title>
  </head>
  <body>
    <header class="header">
      <nav class="nav container">
          <a href="index.html" class="nav__logo">
              <img src="images/logo.png" alt="" class="nav__logo-img">
          </a>

          <div class="nav__menu" id="nav-menu">

              <div class="nav__menu-top">
                  <a href="index.html" class="nav__menu-logo">
                      <img src="images/logo.png" alt="">
                  </a>

                  <div class="nav__close" id="nav-close">
                      <i class="fi fi-rs-cross-small"></i>
                  </div>
              </div>
              
              <ul class="nav__list">
                  <li class="nav__item">
                      <a href="index.html" class="nav__link">Home</a>
                  </li>

                  <li class="nav__item">
                      <a href="shop.html" class="nav__link">Shop</a>
                  </li>

                  <li class="nav__item">
                      <a href="accounts.html" class="nav__link">My Account</a>
                  </li>
              </ul>
          </div>

          <div class="header__user-actions">
              <a href="cart.html" class="header__action-btn">
                  <img src="images/icon-cart.svg" alt="">
                  <span class="count" id="cart-count">3</span>
              </a>

              <div class="header__action-btn nav__toggle" id="nav-toggle">
                  <img src="images/menu-burger.svg" alt="">
              </div>
          </div>
      </nav>
  </header>

    <main class="main">
      <section class="breadcrumb">
        <div class="breadcrumb__list container">
          <a href="index.html" class="breadcrumb__link">Home</a>
          <span class="breadcrumb__link">></span>
          <span class="breadcrumb__link">Cart</span>
        </div>
      </section>

      <section class="cart container section--lg">
        <div class="table__container">
          <table class="table" id="cart-table">
            <tr>
              <th>Image</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Subtotal</th>
              <th>Remove</th>
            </tr>
            <!-- Cart items will be dynamically inserted here -->
          </table>
        </div>

        <div class="cart__actions">
          <a href="shop.html" class="btn flex btn--md">
            <i class="fi-rs-shopping-bag-add"></i> Continue Shopping
          </a>
        </div>

        <div class="divider">
          <i class="fi fi-rs-fingerprint"></i>
        </div>

        <div class="cart__group grid">
          <div class="cart__total">
            <h3 class="section__title">Cart Total</h3>
            <table class="cart__total-table">
              <tr>
                <td><span class="cart__total-title">Cart Subtotal</span></td>
                <td><span class="cart__total-price" id="cart-subtotal">€0</span></td>
              </tr>
              <tr>
                <td><span class="cart__total-title">Shipping</span></td>
                <td><span class="cart__total-price">Free Shipping</span></td>
              </tr>
              <tr>
                <td><span class="cart__total-title">Total</span></td>
                <td><span class="cart__total-price" id="cart-total">€10</span></td>
              </tr>
            </table>
            <a href="checkout.html" class="btn flex btn--md">
              <i class="fi fi-rs-box-alt"></i> Proceed To Checkout
            </a>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer container">
      <div class="footer__container grid">
          <div class="footer__content">
              <a href="index.html" class="footer__logo">
                  <img src="images/logo.png" alt="" class="footer__logo-img">
              </a>

              <h4 class="footer__subtitle">Contact</h4>
              <p class="footer__description">
                  <span>Address:</span> 562 Konrad Duden Weg, Frankfurt, Germany
              </p>

              <p class="footer__description">
                  <span>Phone:</span> 01588745454
              </p>

              <p class="footer__description">
                  <span>Working Hours:</span> 10:00 - 18:00, Mon-Sat
              </p>

              <div class="footer__social">
                  <div class="footer__subtitle">Follow Me</div>
                  <div class="footer_-social-links flex">
                      <a href="#">
                          <img src="images/icon-facebook.svg" alt="" class="footer__social-icon">
                      </a>

                      <a href="#">
                          <img src="images/icon-instagram.svg" alt="" class="footer__social-icon">
                      </a>

                      <a href="#">
                          <img src="images/icon-twitter.svg" alt="" class="footer__social-icon">
                      </a>

                      <a href="#">
                          <img src="images/icon-pinterest.svg" alt="" class="footer__social-icon">
                      </a>

                      <a href="#">
                          <img src="images/icon-youtube.svg" alt="" class="footer__social-icon">
                      </a>
                  </div>

              </div>

          </div>

          <div class="footer__content">
              <h3 class="footer__title">Address</h3>
              <ul class="footer__links">
                  <li><a href="#" class="footer__link">About Us</a></li>
                  <li><a href="#" class="footer__link">Delivery Information</a></li>
                  <li><a href="#" class="footer__link">Privacy Policy</a></li>
                  <li><a href="#" class="footer__link">Terms & Conditions</a></li>
                  <li><a href="#" class="footer__link">Contact Us</a></li>
                  <li><a href="#" class="footer__link">Support Center</a></li>
              </ul>
          </div>

          <div class="footer__content">
              <h3 class="footer__title">My Account</h3>
              <ul class="footer__links">
                  <li><a href="#" class="footer__link">Sign In</a></li>
                  <li><a href="#" class="footer__link">View cart</a></li>
                  <li><a href="#" class="footer__link">Register</a></li>
                  <li><a href="#" class="footer__link">Track My Order</a></li>
                  <li><a href="#" class="footer__link">Help</a></li>
                  <li><a href="#" class="footer__link">Order</a></li>
              </ul>
          </div>

          <div class="footer__content">
              <h3 class="footer__title">Secured Payment Gateways</h3>
              <img src="images/payment-method.png" alt="" class="payment__img">
          </div>
      </div>

      <div class="footer__bottom">
          <p class="copyright">&copy; 2025 Coziture. All Rights Reserved.</p>
      </div>
  </footer>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="js/main.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const cartTable = document.getElementById("cart-table");
        const cartSubtotal = document.getElementById("cart-subtotal");
        const cartTotal = document.getElementById("cart-total");
        const cartCount = document.getElementById("cart-count");

        // Function to update the cart display
        function updateCart() {
          cartTable.innerHTML = `
            <tr>
              <th>Image</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Subtotal</th>
              <th>Remove</th>
            </tr>
          `; // Reset the table

          let subtotal = 0;

          // Loop through each cart item
          cart.forEach((item, index) => {
            fetch(`http://WebshopBackend-env.eba-xvipbktv.us-east-1.elasticbeanstalk.com/api/products/${item.product.productId}`)
              .then((response) => response.json())
              .then((product) => {
                const productRow = document.createElement("tr");

                productRow.innerHTML = `
                  <td><img src="images/${product.imageUrl}1.jpg" alt="${product.productName}" class="table__img" /></td>
                  <td>
                    <h3 class="table__title">${product.productName}</h3>
                    <p class="table__description">${product.description}</p>
                  </td>
                  <td><span class="table__price">€${product.basePrice}</span></td>
                  <td><input type="number" class="quantity" value="${item.quantity}" data-index="${index}" /></td>
                  <td><span class="table__subtotal">€${(item.quantity * product.basePrice).toFixed(2)}</span></td>
                  <td><i class="fi fi-rs-trash table__trash" data-index="${index}"></i></td>
                `;

                cartTable.appendChild(productRow);

                subtotal += item.quantity * product.basePrice;

                // Update the subtotal and total
                cartSubtotal.textContent = `€${subtotal.toFixed(2)}`;
                cartTotal.textContent = `€${(subtotal).toFixed(2)}`; // Adding shipping cost of 10€

                // Update cart count
                cartCount.textContent = cart.length;
              });
          });
        }

        // Handle quantity change
        cartTable.addEventListener("input", function (e) {
          if (e.target.classList.contains("quantity")) {
            const index = e.target.dataset.index;
            cart[index].quantity = parseInt(e.target.value);
            localStorage.setItem("cart", JSON.stringify(cart));
            updateCart(); // Recalculate the cart
          }
        });

        // Handle remove item
        cartTable.addEventListener("click", function (e) {
          if (e.target.classList.contains("table__trash")) {
            const index = e.target.dataset.index;
            cart.splice(index, 1); // Remove item from cart
            localStorage.setItem("cart", JSON.stringify(cart));
            updateCart(); // Recalculate the cart
          }
        });

        // Initial cart render
        updateCart();
      });
    </script>
  </body>
</html>
