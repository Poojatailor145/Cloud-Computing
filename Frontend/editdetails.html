<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-straight/css/uicons-regular-straight.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <title>Coziture</title>
  </head>
  <body>
    <!--=============== HEADER ===============-->
    <header class="header">
      <nav class="nav container">
        <a href="index.html" class="nav__logo"><img src="images/logo.png" alt="" class="nav__logo-img" /></a>
        <div class="nav__menu" id="nav-menu">
          <ul class="nav__list">
            <li class="nav__item"><a href="index.html" class="nav__link">Home</a></li>
            <li class="nav__item"><a href="shop.html" class="nav__link">Shop</a></li>
            <li class="nav__item"><a href="accounts.html" class="nav__link">My Account</a></li>
          </ul>
        </div>
        <div class="header__user-actions">
          <a href="cart.html" class="header__action-btn">
            <img src="images/icon-cart.svg" alt="" />
            <span class="count" id="cart-count">0</span>
          </a>
        </div>
      </nav>
    </header>

    <!--=============== MAIN ===============-->
    <main class="main">
      <!--=============== BREADCRUMB ===============-->
      <section class="breadcrumb">
        <div class="breadcrumb__list container">
          <a href="index.html" class="breadcrumb__link">Home</a>
          <span class="breadcrumb__link">></span>
          <span class="breadcrumb__link">My Account</span>
        </div>
      </section>

      <!--=============== LOGIN-REGISTER ===============-->
      <section class="login-register section--lg">
        <div class="login-register__container container grid">
          <div class="login">
            <h3 class="section__title">Edit User Details</h3>
            <form action="" class="form grid" id="edit-user-form">
              <label for="address">Address</label>
              <input type="text" id="new-address" placeholder="Your Address" class="form__input" required />
              
              <label for="email">Email</label>
              <input type="email" id="new-email" placeholder="Your Email" class="form__input" required />
              
              <label for="phone">Phone</label>
              <input type="text" id="new-phone" placeholder="Your Phone Number" class="form__input" required />
              
              <div class="form__btn">
                <button type="submit" class="btn">Save Changes</button>
              </div>
            </form>
          </div>
        </div>
      </section>

    </main>

    <!--=============== FOOTER ===============-->
    <footer class="footer container">
      <div class="footer__container grid">
        <div class="footer__content">
          <a href="index.html" class="footer__logo"><img src="images/logo.png" alt="" class="footer__logo-img" /></a>
          <h4 class="footer__subtitle">Contact</h4>
          <p class="footer__description"><span>Address:</span> 562 Konrad Duden Weg, Frankfurt, Germany</p>
          <p class="footer__description"><span>Phone:</span> 01588745454</p>
          <p class="footer__description"><span>Working Hours:</span> 10:00 - 18:00, Mon-Sat</p>
        </div>
      </div>
    </footer>

    <!--=============== SWIPER JS ===============-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <!--=============== MAIN JS ===============-->
    <script src="js/main.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const userId = 1; // assuming the user ID is 1
        const editUserForm = document.getElementById('edit-user-form');
        const newAddressInput = document.getElementById('new-address');
        const newEmailInput = document.getElementById('new-email');
        const newPhoneInput = document.getElementById('new-phone');
        const fname ='Aerika Modi';

        // Fetch user details from API
        fetch(`http://localhost:5000/api/users/${userId}`)
          .then((response) => response.json())
          .then((user) => {
            // Populate fields with existing user data
            newAddressInput.value = user.address;
            newEmailInput.value = user.email;
            newPhoneInput.value = user.phoneNumber;
            fname = user.fullName;
          })
          .catch((error) => {
            console.error('Error fetching user details:', error);
          });

        // Handle form submission to update user details
        editUserForm.addEventListener("submit", function (e) {
          e.preventDefault();

          // Get updated user details from the form inputs
          const updatedUser = {
            email: newEmailInput.value,
            fullName: fname,
            phoneNumber: newPhoneInput.value,
            address: newAddressInput.value,
          };

          // Send updated data to the API
          fetch(`http://localhost:5000/api/users/1`, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(updatedUser),
          })
            .then((response) => response.json())
            .then((data) => {
              // Successfully updated user data
              window.location.href='accounts.html';
              console.log(data);
            })
            .catch((error) => {
              console.error("Error updating user details:", error);
              alert("There was an error updating the details.");
            });
        });
      });
    </script>
  </body>
</html>
